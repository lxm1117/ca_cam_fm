species ca				# 1
species cam				# 2	
species bK

#molecule_lists ca cam
molecule_lists total
#mol_list ca ca
#mol_list cam cam
mol_list * total

sites	ca 	@cam
sites   cam	@N1 @N2	@C1 @C2 @K Kp
sites 	bK 	@cam P

dif_sites ca	cam
dif_sites cam	K

#-------------------------faas and mody 2012
define camN1_on 2618000
define camN2_on	54400000
define camC1_on	285600
define camC2_on	42500

define camN1_off 160
define camN2_off 44
define camC1_off 2.6
define camC2_off 0.013

reaction camN1-ca	cam{N1==0,N2==0,K==0,Kp==0} + ca{cam==0} -> cam[N1=1]~ca[cam=1]	camN1_on
reaction camC1-ca	cam{C1==0,C2==0,K==0,Kp==0} + ca{cam==0} -> cam[C1=1]~ca[cam=1]	camC1_on
#reaction camN2C-ca	cam{N1==1,N2==0,C2==0,K==0,Kp==0} + ca{cam==0} -> cam[N2=1]~ca[cam=1]	camN2_on
#reaction camC2N-ca	cam{C1==1,C2==0,N2==0,K==0,Kp==0} + ca{cam==0} -> cam[C2=1]~ca[cam=1]	camC2_on
reaction camC2-ca	cam{C1==1,C2==0,K==0,Kp==0} + ca{cam==0} -> cam[C2=1]~ca[cam=1]	camC2_on
reaction camN2-ca	cam{N1==1,N2==0,K==0,Kp==0} + ca{cam==0} -> cam[N2=1]~ca[cam=1]	camN2_on

#------------------------

reaction camN1-ca_r	cam{N1==1,N2==0,K==0,Kp==0}~ca{cam==1} -> cam[N1=0] + ca[cam=0]	camN1_off
reaction camC1-ca_r	cam{C1==1,C2==0,K==0,Kp==0}~ca{cam==1} -> cam[C1=0] + ca[cam=0]	camC1_off
#reaction camN2C-ca_r	cam{N1==1,N2==1,C2==0,K==0,Kp==0}~ca{cam==1} -> cam[N2=0] + ca[cam=0]	camN2_off
#reaction camC2N-ca_r	cam{C1==1,C2==1,N2==0,K==0,Kp==0}~ca{cam==1} -> cam[C2=0] + ca[cam=0]	camC2_off
reaction camN2-ca_r	cam{N1==1,N2==1,K==0,Kp==0}~ca{cam==1} -> cam[N2=0] + ca[cam=0]	camN2_off
reaction camC2-ca_r	cam{C1==1,C2==1,K==0,Kp==0}~ca{cam==1} -> cam[C2=0] + ca[cam=0]	camC2_off

#--- cam binding with unphosphorylated bK and gK---------------------------------------------
define K-camN0C0_on	 6.46		#340 	# 6.46
define K-camN0C1_on	 100.3		#3400	# 100.3		
define K-camN0C2_on	 1564		#17000	# 1564	

define K-camN1C1_on	 561		#17000	# 561
define K-camN1C2_on	 8840		#34000	# 8840
define K-camN1C0_on	 37.4		#3400	# 37.4	

define K-camN2C0_on	 204		#17000	# 204
define K-camN2C1_on	 3230		#34000	# 3230
define K-camN2C2_on	 26350		#85000	# 102000

define K-camN0C0_off 0.0055	 		#0.09		# 0.0055	
define K-camN0C1_off 0.0061		#0.09		# 0.0061		
define K-camN0C2_off 0.0068		#0.045		# 0.0068	
define K-camN1C1_off 0.0034		#0.045		# 0.0034
define K-camN1C2_off 0.0038		#0.009		# 0.0038
define K-camN1C0_off 0.0031		#0.09		# 0.0031
define K-camN2C0_off 0.0017		#0.045		# 0.0017
define K-camN2C1_off 0.0019		#0.009		# 0.0019
define K-camN2C2_off 0.0011		#0.00225	# 0.0023

#----------------------------------------------------------------------------------------------------------------------------
reaction bK-camN0C0	bK{cam==0,P==0} + cam{N1==0,N2==0,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN0C0_on
reaction bK-camN0C1	bK{cam==0,P==0} + cam{N1==0,N2==0,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN0C1_on
reaction bK-camN0C2	bK{cam==0,P==0} + cam{N1==0,N2==0,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN0C2_on	

reaction bK-camN1C0	bK{cam==0,P==0} + cam{N1==1,N2==0,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN1C0_on
reaction bK-camN1C1	bK{cam==0,P==0} + cam{N1==1,N2==0,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN1C1_on
reaction bK-camN1C2	bK{cam==0,P==0} + cam{N1==1,N2==0,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN1C2_on	

reaction bK-camN2C0	bK{cam==0,P==0} + cam{N1==1,N2==1,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN2C0_on
reaction bK-camN2C1	bK{cam==0,P==0} + cam{N1==1,N2==1,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN2C1_on
reaction bK-camN2C2	bK{cam==0,P==0} + cam{N1==1,N2==1,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1] K-camN2C2_on	

reaction bK-camN0C0_r	bK{cam==1,P==0}~cam{N1==0,N2==0,C1==0,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN0C0_off 
reaction bK-camN0C1_r	bK{cam==1,P==0}~cam{N1==0,N2==0,C1==1,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN0C1_off 
reaction bK-camN0C2_r	bK{cam==1,P==0}~cam{N1==0,N2==0,C1==1,C2==1,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN0C2_off 

reaction bK-camN1C0_r	bK{cam==1,P==0}~cam{N1==1,N2==0,C1==0,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN1C0_off 
reaction bK-camN1C1_r	bK{cam==1,P==0}~cam{N1==1,N2==0,C1==1,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN1C1_off 
reaction bK-camN1C2_r	bK{cam==1,P==0}~cam{N1==1,N2==0,C1==1,C2==1,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN1C2_off 

reaction bK-camN2C0_r	bK{cam==1,P==0}~cam{N1==1,N2==1,C1==0,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN2C0_off 
reaction bK-camN2C1_r	bK{cam==1,P==0}~cam{N1==1,N2==1,C1==1,C2==0,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN2C1_off 
reaction bK-camN2C2_r	bK{cam==1,P==0}~cam{N1==1,N2==1,C1==1,C2==1,K==1,Kp==0} -> bK[cam=0] + cam[K=0] K-camN2C2_off 


#--ca, naive (unphosphorylated) bK/gK/camKK/camKIV-caM binding unbinding-----------------------------------------------------
define KcamN1_on  2094400	# 1540*0.8*1700	
define KcamN2_on  43520000	# 32000*0.8*1700	
define KcamC1_on  2499000	# 168*8.75*1700
define KcamC2_on  371875	# 25*8.75*1700
	
define KcamN1_off 12.8		# 160000/12.5/1000
define KcamN2_off 3.52 		# 44000/12.5/1000	
define KcamC1_off 1.625		# 2600/1.6/1000
define KcamC2_off 0.008125		# 13/1.6/1000

reaction KcamN1~ca	cam{K==1,Kp==0,N1==0,N2==0} + ca{cam==0} -> cam[N1=1]~ca[cam=1]	KcamN1_on		
reaction KcamC1~ca	cam{K==1,Kp==0,C1==0,C2==0} + ca{cam==0} -> cam[C1=1]~ca[cam=1]	KcamC1_on
#reaction KcamN2C~ca	cam{K==1,Kp==0,N1==1,N2==0,C2==0} + ca{cam==0} -> cam[N2=1]~ca[cam=1] 		KcamN2_on
#reaction KcamC2N~ca	cam{K==1,Kp==0,C1==1,C2==0,N2==0} + ca{cam==0} -> cam[C2=1]~ca[cam=1] 		KcamC2_on
reaction KcamN2~ca	cam{K==1,Kp==0,N1==1,N2==0} + ca{cam==0} -> cam[N2=1]~ca[cam=1] 		KcamN2_on
reaction KcamC2~ca	cam{K==1,Kp==0,C1==1,C2==0} + ca{cam==0} -> cam[C2=1]~ca[cam=1] 		KcamC2_on

reaction KcamN1~ca_r	cam{K==1,Kp==0,N1==1,N2==0}~ca{cam==1} -> cam[N1=0] + ca[cam=0]	KcamN1_off
reaction KcamC1~ca_r	cam{K==1,Kp==0,C1==1,C2==0}~ca{cam==1} -> cam[C1=0] + ca[cam=0]	KcamC1_off
#reaction KcamN2C~ca_r	cam{K==1,Kp==0,N1==1,N2==1,C2==0}~ca{cam==1} -> cam[N2=0] + ca[cam=0]			KcamN2_off
#reaction KcamC2N~ca_r	cam{K==1,Kp==0,C1==1,C2==1,N2==0}~ca{cam==1} -> cam[C2=0] + ca[cam=0] 		KcamC2_off	
reaction KcamN2~ca_r	cam{K==1,Kp==0,N1==1,N2==1}~ca{cam==1} -> cam[N2=0] + ca[cam=0]			KcamN2_off
reaction KcamC2~ca_r	cam{K==1,Kp==0,C1==1,C2==1}~ca{cam==1} -> cam[C2=0] + ca[cam=0] 		KcamC2_off	

/*
#--- cam binding with phosphorylated bK and gK---------------------------------------------
# actually, the same as K-camNxCx_on
#define Kp-camN0C0_on		#340

define Kp-camN1C0_on 37.4	#3400			
define Kp-camN0C1_on 100.3	#3400		
define Kp-camN1C1_on 561	#17000
define Kp-camN2C0_on 204	#17000	
define Kp-camN0C2_on 1564	#17000
define Kp-camN2C1_on 3230	#34000
define Kp-camN1C2_on 8840	#34000
define Kp-camN2C2_on 26350	#85000

#define Kp-camN0C0_off 	#0.00009	
define Kp-camN1C0_off 0.00003454	#0.00009
define Kp-camN0C1_off 0.0009912		#0.00009	
define Kp-camN1C1_off 0.00003696	#0.00045
define Kp-camN2C0_off 0.000018828	#0.00045
define Kp-camN0C2_off 0.000138		#0.00045	
define Kp-camN2C1_off 0.0002128		#0.000009
define Kp-camN1C2_off 0.0000052		#0.000009
define Kp-camN2C2_off 0.00000155	#0.00000225

#reaction bKp-camN0C0	bK{cam==0,P==1} + cam{N1==0,N2==0,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN0C0_on
reaction bKp-camN0C1	bK{cam==0,P==1} + cam{N1==0,N2==0,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN0C1_on
reaction bKp-camN0C2	bK{cam==0,P==1} + cam{N1==0,N2==0,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN0C2_on	

reaction bKp-camN1C0	bK{cam==0,P==1} + cam{N1==1,N2==0,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN1C0_on
reaction bKp-camN1C1	bK{cam==0,P==1} + cam{N1==1,N2==0,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN1C1_on
reaction bKp-camN1C2	bK{cam==0,P==1} + cam{N1==1,N2==0,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN1C2_on	

reaction bKp-camN2C0	bK{cam==0,P==1} + cam{N1==1,N2==1,C1==0,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN2C0_on
reaction bKp-camN2C1	bK{cam==0,P==1} + cam{N1==1,N2==1,C1==1,C2==0,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN2C1_on
reaction bKp-camN2C2	bK{cam==0,P==1} + cam{N1==1,N2==1,C1==1,C2==1,K==0,Kp==0} -> bK[cam=1]~cam[K=1,Kp=1] Kp-camN2C2_on	

reaction bKp-camN0C0_r	bK{cam==1,P==1}~cam{N1==0,N2==0,C1==0,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN0C0_off 
reaction bKp-camN0C1_r	bK{cam==1,P==1}~cam{N1==0,N2==0,C1==1,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN0C1_off 
reaction bKp-camN0C2_r	bK{cam==1,P==1}~cam{N1==0,N2==0,C1==1,C2==1,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN0C2_off 

reaction bKp-camN1C0_r	bK{cam==1,P==1}~cam{N1==1,N2==0,C1==0,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN1C0_off 
reaction bKp-camN1C1_r	bK{cam==1,P==1}~cam{N1==1,N2==0,C1==1,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN1C1_off 
reaction bKp-camN1C2_r	bK{cam==1,P==1}~cam{N1==1,N2==0,C1==1,C2==1,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN1C2_off 

reaction bKp-camN2C0_r	bK{cam==1,P==1}~cam{N1==1,N2==1,C1==0,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN2C0_off 
reaction bKp-camN2C1_r	bK{cam==1,P==1}~cam{N1==1,N2==1,C1==1,C2==0,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN2C1_off 
reaction bKp-camN2C2_r	bK{cam==1,P==1}~cam{N1==1,N2==1,C1==1,C2==1,K==1,Kp==1} -> bK[cam=0] + cam[K=0,Kp=0] Kp-camN2C2_off 

#----- bK autophosphorylation-------------------------------------------------------
# define Kp-camN0C0	0
define Kp-camN0C1 0.00001 	#0.01 s^-1
define Kp-camN0C2 0.00008	#0.08 s^-1
define Kp-camN1C0 0.00015	#0.15 s^-1
define Kp-camN1C1 0.00015	#0.15 s^-1
define Kp-camN1C2 0.0012	#1.2 s^-1
define Kp-camN2C0 0.00015	#0.15 s^-1 
define Kp-camN2C1 0.00015	#0.15 s^-1
define Kp-camN2C2 0.0012	#1.2 s^-1

reaction bKpcamN0C1	bK{P==0,cam==1}~cam{N1==0,N2==0,C1==1,C2==0,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1] 	Kp-camN0C1
reaction bKpcamN0C2 bK{P==0,cam==1}~cam{N1==0,N2==0,C1==1,C2==1,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1] 	Kp-camN0C2

reaction bKpcamN1C0	bK{P==0,cam==1}~cam{N1==1,N2==0,C1==0,C2==0,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1]	Kp-camN1C0
reaction bKpcamN1C1	bK{P==0,cam==1}~cam{N1==1,N2==0,C1==1,C2==0,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1]	Kp-camN1C1
reaction bKpcamN1C2 bK{P==0,cam==1}~cam{N1==1,N2==0,C1==1,C2==1,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1]	Kp-camN1C2

reaction bKpcamN2C0	bK{P==0,cam==1}~cam{N1==1,N2==1,C1==0,C2==0,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1]	Kp-camN2C1
reaction bKpcamN2C1	bK{P==0,cam==1}~cam{N1==1,N2==1,C1==1,C2==0,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1]	Kp-camN2C1
reaction bKpcamN2C2 bK{P==0,cam==1}~cam{N1==1,N2==1,C1==1,C2==1,K==1,Kp==0} -> bK[cam=1,P=1]~cam[K=1,Kp=1] 	Kp-camN2C2

#--bK dephos-------------------------------------------
define K-dephos 0.003 #0.000003
reaction bK-cam_dephos	bK{P==1,cam==1}~cam{K==1,Kp==1} -> bK[cam=1,P=0]~cam[K=1,Kp=0]	K-dephos
reaction bK_dephos	bK{P==1,cam==0} -> bK[P=0]	K-dephos

#--ca, phosphorylated bK/gK  binding unbinding-----------------------------------------------------
define KpcamN1_on 2094400		#1232*1700	#680		
define KpcamN2_on 43520000		#25600*1700	#5610
define KpcamC1_on 2499000		#1470*1700	#10200
define KpcamC2_on 371875		#218.75*1700 #18700
	
define KpcamN1_off 0.853		#12800.0/15/1000 #0.0004
define KpcamN2_off 3.52			#3520.0/1000	 #0.0004
define KpcamC1_off 1.625		#1625.0/1000	 #0.0012
define KpcamC2_off 0.001015625	#8.125/8/1000	 #0.011

reaction KpcamN1~ca	cam{K==1,Kp==1,N1==0,N2==0} + ca{cam==0} -> cam[N1=1]~ca[cam=1]	KpcamN1_on		
reaction KpcamC1~ca	cam{K==1,Kp==1,C1==0,C2==0} + ca{cam==0} -> cam[C1=1]~ca[cam=1]	KpcamC1_on
reaction KpcamN2~ca	cam{K==1,Kp==1,N1==1,N2==0} + ca{cam==0} -> cam[N2=1]~ca[cam=1] KpcamN2_on
reaction KpcamC2~ca	cam{K==1,Kp==1,C1==1,C2==0} + ca{cam==0} -> cam[C2=1]~ca[cam=1] KpcamC2_on

reaction KpcamN1~ca_r	cam{K==1,Kp==1,N1==1,N2==0}~ca{cam==1} -> cam[N1=0] + ca[cam=0]	KpcamN1_off
reaction KpcamC1~ca_r	cam{K==1,Kp==1,C1==1,C2==0}~ca{cam==1} -> cam[C1=0] + ca[cam=0]	KpcamC1_off
reaction KpcamN2~ca_r	cam{K==1,Kp==1,N1==1,N2==1}~ca{cam==1} -> cam[N2=0] + ca[cam=0]	KpcamN2_off
reaction KpcamC2~ca_r	cam{K==1,Kp==1,C1==1,C2==1}~ca{cam==1} -> cam[C2=0] + ca[cam=0] KpcamC2_off	
*/
reaction end
